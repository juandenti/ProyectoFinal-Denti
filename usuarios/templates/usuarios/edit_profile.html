{% extends "padre.html" %}

{% block title %}Editar Perfil{% endblock title %}

{% block content %}

<div class="container" style="max-width: 600px; margin: 50px auto; padding: 30px; background: #f9f9f9; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">

    <h2 class="text-center mb-4" style="color: #333;">Editar Perfil</h2>

    <!-- Formulario para actualizar datos y avatar -->
    <form method="post" enctype="multipart/form-data" style="margin-bottom: 30px;">
        {% csrf_token %}

        <fieldset class="mb-3 border p-3 rounded">
            <legend style="font-size: 1.1rem; font-weight: bold;">Datos de Usuario</legend>
            {% for field in user_form %}
                <div class="mb-3 text-start">
                    <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                    {{ field }}
                    {% if field.help_text %}
                        <small class="form-text text-muted">{{ field.help_text }}</small>
                    {% endif %}
                    {% for error in field.errors %}
                        <div class="text-danger" style="font-size: 0.875rem;">{{ error }}</div>
                    {% endfor %}
                </div>
            {% endfor %}
        </fieldset>

        <fieldset class="mb-3 border p-3 rounded">
            <legend style="font-size: 1.1rem; font-weight: bold;">Avatar</legend>
            {% if user.avatar and user.avatar.imagen %}
                <div class="text-center mb-3">
                    <img src="{{ user.avatar.imagen.url }}" alt="Avatar de {{ user.username }}" class="rounded-circle" width="100" style="border: 2px solid #ccc; padding: 2px;">
                </div>
            {% endif %}
            {% for field in avatar_form %}
                <div class="mb-3 text-start">
                    <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                    {{ field }}
                    {% if field.help_text %}
                        <small class="form-text text-muted">{{ field.help_text }}</small>
                    {% endif %}
                    {% for error in field.errors %}
                        <div class="text-danger" style="font-size: 0.875rem;">{{ error }}</div>
                    {% endfor %}
                </div>
            {% endfor %}
        </fieldset>

        <button type="submit" name="update_profile" class="btn btn-primary w-100 mb-4" style="padding: 10px; font-size: 1rem; border-radius: 6px;">Actualizar Perfil y Avatar</button>
    </form>

    <hr>

    <!-- Formulario para cambiar contraseña -->
    <form method="post">
        {% csrf_token %}

        <fieldset class="mb-3 border p-3 rounded">
            <legend style="font-size: 1.1rem; font-weight: bold;">Cambiar Contraseña</legend>
            {% for field in password_form %}
                <div class="mb-3 text-start">
                    <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                    {{ field }}
                    {% if field.help_text %}
                        <small class="form-text text-muted">{{ field.help_text }}</small>
                    {% endif %}
                    {% for error in field.errors %}
                        <div class="text-danger" style="font-size: 0.875rem;">{{ error }}</div>
                    {% endfor %}
                </div>
            {% endfor %}
        </fieldset>

        <button type="submit" name="change_password" class="btn btn-success w-100" style="padding: 10px; font-size: 1rem; border-radius: 6px;">Cambiar Contraseña</button>
    </form>

</div>

{% endblock %}
